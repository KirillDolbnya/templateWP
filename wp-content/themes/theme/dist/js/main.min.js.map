{"version":3,"sources":["components/cart.js","components/order.js"],"names":["jQuery","document","ready","$","updateCartInfo","cartInfo","price","count","totalQuantity","text","totalPrice","toFixed","showAlert","message","console","log","on","productID","this","data","button","post","ajaxData","ajaxurl","action","product_id","quantity","done","response","productId","success","replaceWith","fail","closest","qtyElement","siblings","newQty","parseInt","val","hasClass","remove","updateHiddenFields","delivery","find","trim","payment","attr","removeAttr","handleRadioChange","selector","prop","e","preventDefault","formData","serialize","ajax","type","url","form_data","beforeSend","html","alert","order_id","empty","error"],"mappings":"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","file":"main.min.js","sourcesContent":["jQuery( document ).ready(function($) {\r\n    $('body').on('click', '.js-cart', function () {\r\n        const productID = $(this).data('product-id');\r\n        const button = $(this);\r\n\r\n        $.post(ajaxData.ajaxurl, {\r\n            action: 'add_to_cart',\r\n            product_id: productID,\r\n            quantity: 1\r\n        }).done(function (response) {\r\n            if (response.success) {\r\n                updateProductButton(button, response.data.productId, 1);\r\n                updateCartInfo(response.data.cartInfo);\r\n                showAlert(response.data.message);\r\n            } else {\r\n                showAlert(response.data.message);\r\n            }\r\n        }).fail(function () {\r\n            showAlert('Ошибка добавления товара. Попробуйте позже.');\r\n        });\r\n    });\r\n\r\n    $('body').on('click', '.quantity-control .increase-qty, .quantity-control .decrease-qty', function () {\r\n        const productID = $(this).closest('.quantity-control').data('product-id');\r\n        const qtyElement = $(this).siblings('.product-qty');\r\n        let newQty = parseInt(qtyElement.val(), 10);\r\n\r\n        newQty = $(this).hasClass('increase-qty') ? newQty + 1 : newQty - 1;\r\n\r\n        $.post(ajaxData.ajaxurl, {\r\n            action: 'update_product_quantity',\r\n            product_id: productID,\r\n            quantity: newQty\r\n        }).done(function (response) {\r\n            if (response.success) {\r\n                if (newQty > 0) {\r\n                    qtyElement.val(newQty);\r\n                } else {\r\n                    replaceWithAddButton(productID);\r\n                }\r\n                updateCartInfo(response.data.cartInfo);\r\n                showAlert(response.data.message);\r\n            } else {\r\n                showAlert(response.data.message);\r\n            }\r\n        }).fail(function () {\r\n            showAlert('Ошибка обновления количества. Попробуйте позже.');\r\n        });\r\n    });\r\n\r\n    $('body').on('click', '.js-cart-remove', function () {\r\n        const productID = $(this).data('product-id');\r\n\r\n        $.post(ajaxData.ajaxurl, {\r\n            action: 'remove_from_cart',\r\n            product_id: productID\r\n        }).done(function (response) {\r\n            if (response.success) {\r\n                $(`.js-cart-remove[data-product-id=\"${productID}\"]`).closest('.cart__item').remove();\r\n                updateCartInfo(response.data.cartInfo);\r\n                showAlert(response.data.message);\r\n\r\n                if (response.data.cartInfo.totalQuantity === 0) {\r\n                    $('.cart__content').replaceWith('<p class=\"cart__empty\">Ваша корзина пуста</p>');\r\n                }\r\n            } else {\r\n                showAlert(response.data.message);\r\n            }\r\n        }).fail(function () {\r\n            showAlert('Ошибка при удалении товара. Попробуйте позже.');\r\n        });\r\n    });\r\n\r\n    function updateProductButton(button, productId, quantity) {\r\n        button.replaceWith(`\r\n        <div class=\"quantity-control\" data-product-id=\"${productId}\">\r\n            <button class=\"decrease-qty\">\r\n                <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\">\r\n                    <path d=\"M21 12C21 12.1989 20.921 12.3897 20.7803 12.5303C20.6397 12.671 20.4489 12.75 20.25 12.75H3.75C3.55109 12.75 3.36032 12.671 3.21967 12.5303C3.07902 12.3897 3 12.1989 3 12C3 11.8011 3.07902 11.6103 3.21967 11.4697C3.36032 11.329 3.55109 11.25 3.75 11.25H20.25C20.4489 11.25 20.6397 11.329 20.7803 11.4697C20.921 11.6103 21 11.8011 21 12Z\" fill=\"#3300FF\"/>\r\n                </svg>\r\n            </button>\r\n            <input class=\"product-qty\" value=\"${quantity}\" readonly>\r\n            <button class=\"increase-qty\">\r\n                <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\">\r\n                    <path d=\"M21 12C21 12.1989 20.921 12.3897 20.7803 12.5303C20.6397 12.671 20.4489 12.75 20.25 12.75H12.75V20.25C12.75 20.4489 12.671 20.6397 12.5303 20.7803C12.3897 20.921 12.1989 21 12 21C11.8011 21 11.6103 20.921 11.4697 20.7803C11.329 20.6397 11.25 20.4489 11.25 20.25V12.75H3.75C3.55109 12.75 3.36032 12.671 3.21967 12.5303C3.07902 12.3897 3 12.1989 3 12C3 11.8011 3.07902 11.6103 3.21967 11.4697C3.36032 11.329 3.55109 11.25 3.75 11.25H11.25V3.75C11.25 3.55109 11.329 3.36032 11.4697 3.21967C11.6103 3.07902 11.8011 3 12 3C12.1989 3 12.3897 3.07902 12.5303 3.21967C12.671 3.36032 12.75 3.55109 12.75 3.75V11.25H20.25C20.4489 11.25 20.6397 11.329 20.7803 11.4697C20.921 11.6103 21 11.8011 21 12Z\" fill=\"#3300FF\"/>\r\n                </svg>\r\n            </button>\r\n        </div>\r\n    `);\r\n    }\r\n\r\n    function replaceWithAddButton(productId) {\r\n        $(`.quantity-control[data-product-id=\"${productId}\"]`).replaceWith(`\r\n        <button class=\"js-cart productCard__btn catalog__item-btn primary\" data-product-id=\"${productId}\">\r\n            В корзину\r\n        </button>\r\n    `);\r\n    }\r\n\r\n    function updateCartInfo(cartInfo) {\r\n        updateCartCount(cartInfo.totalQuantity);\r\n        updateCartPrice(cartInfo.totalPrice);\r\n    }\r\n\r\n    function updateCartCount(count) {\r\n        $('.js-cart-count').text(count);\r\n    }\r\n\r\n    function updateCartPrice(price) {\r\n        $('.js-cart-price').text(price.toFixed(2));\r\n    }\r\n\r\n    function showAlert(message) {\r\n        // alert(message);\r\n        console.log(message);\r\n    }\r\n});","jQuery( document ).ready(function($) {\r\n\r\n    function updateHiddenFields() {\r\n        const delivery = $('.cart__order-delivery--item input[type=\"radio\"]:checked')\r\n            .siblings('.cart__order-delivery--item_info')\r\n            .find('p').text().trim();\r\n\r\n        const payment = $('.cart__order-payment--item input[type=\"radio\"]:checked')\r\n            .siblings('.cart__order-payment--item_info')\r\n            .find('p').text().trim();\r\n\r\n        $('#selected-delivery').val(delivery);\r\n        $('#selected-payment').val(payment);\r\n\r\n        // Добавляем или убираем атрибут disabled у поля адреса\r\n        if (delivery === 'Самовывоз') {\r\n            $('input[name=\"address\"]').attr('disabled', true).val(''); // Очищаем поле при самовывозе\r\n        } else {\r\n            $('input[name=\"address\"]').removeAttr('disabled');\r\n        }\r\n    }\r\n\r\n// Инициализация и обработка событий\r\n    updateHiddenFields();\r\n\r\n    function handleRadioChange(selector) {\r\n        $(selector).on('change', 'input[type=\"radio\"]', function () {\r\n            $(selector + ' input[type=\"radio\"]').prop('checked', false);\r\n            $(this).prop('checked', true);\r\n            updateHiddenFields();\r\n        });\r\n    }\r\n\r\n    handleRadioChange('.cart__order-delivery--item');\r\n    handleRadioChange('.cart__order-payment--item');\r\n\r\n// Отправка формы через AJAX\r\n    $(\"body\").on('submit', '#checkout-form', function (e) {\r\n        e.preventDefault();\r\n        const form = $(this);\r\n        const formData = form.serialize();\r\n\r\n        $.ajax({\r\n            type: 'POST',\r\n            url: ajaxData.ajaxurl,\r\n            data: {\r\n                action: 'process_checkout',\r\n                form_data: formData,\r\n            },\r\n            beforeSend: () => $('#order-result').html('<p>Обработка заказа...</p>'),\r\n            success: (response) => {\r\n                if (response.success) {\r\n                    alert(`Заказ №${response.data.order_id} успешно оформлен!`);\r\n                    $('.cart__container').html('<p>Ваша корзина пуста</p>');\r\n                    $('#order-result').empty();\r\n                } else {\r\n                    $('#order-result').html(`<p style=\"color: red;\">Ошибка: ${response.data.message}</p>`);\r\n                }\r\n            },\r\n            error: () => $('#order-result').html('<p style=\"color: red;\">Ошибка сервера. Попробуйте снова.</p>'),\r\n        });\r\n    });\r\n});"]}